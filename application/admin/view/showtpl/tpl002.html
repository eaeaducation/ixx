<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <!--<meta name=”viewport” content=”width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0,  user-scalable=yes”/>-->
    <!-- Link Swiper's CSS -->
    <link rel="stylesheet" href="/static/extend_res/swiper/css/swiper-4.3.3.min.css">
    <link rel="stylesheet" href="/static/extend_res/swiper/css/animate.min.css">
    <link rel="stylesheet" href="/static/temp/tpl002/css/index.css">
    <!-- Demo styles -->
</head>
<body>
<!-- Swiper -->
<div class="swiper-container">
    <div class="swiper-wrapper">
        <div class="swiper-slide bg1">
            <div class="ani">
                <div class="z1_title">
                    <h1 class="ani" swiper-animate-effect="bounceInLeft" swiper-animate-duration="0.6s"
                        swiper-animate-delay="0.3s"></h1>
                </div>
                <div class="z1_content">
                    <h3 class="ani" swiper-animate-effect="bounceInLeft" swiper-animate-duration="0.8s"
                        swiper-animate-delay="0.5s"></h3>
                    <p class="ani" swiper-animate-effect="bounceInLeft" swiper-animate-duration="1s"
                       swiper-animate-delay="0.7s"></p>
                </div>
                <div class="z1_foot">
                    <div class="z1_foot_left"></div>
                    <div class="z1_foot_right"></div>
                </div>
            </div>

        </div>

        <div class="swiper-slide bg2">
            <div class="ani">
                <img class="z2_title_img ani" swiper-animate-effect="wobble" swiper-animate-duration="0.5s"
                     swiper-animate-delay="0.1s">
                <div class="z2_content">
                    <h3 class="ani" swiper-animate-effect="bounceInLeft" swiper-animate-duration="0.8s"
                        swiper-animate-delay="0.3s"></h3>
                    <p class="ani" swiper-animate-effect="bounceInRight" swiper-animate-duration="1.0s"
                       swiper-animate-delay="0.5s"></p>
                    <img class="ani" swiper-animate-effect="bounceInUp" swiper-animate-duration="1.2s"
                         swiper-animate-delay="0.7s">
                </div>
            </div>
        </div>
        <div class="swiper-slide bg3">
            <div class="ani">
                <img class="z3_title_img ani" swiper-animate-effect="zoomIn" swiper-animate-duration="0.5s"
                     swiper-animate-delay="0.1s">
                <div class="z3_content">
                    <h3 class="ani" swiper-animate-effect="zoomInDown" swiper-animate-duration="0.8s"
                        swiper-animate-delay="0.3s"></h3>
                    <p class="ani" swiper-animate-effect="zoomInLeft" swiper-animate-duration="1.1s"
                       swiper-animate-delay="0.6s"></p>
                    <img class="ani" swiper-animate-effect="zoomInRight" swiper-animate-duration="1.4s"
                         swiper-animate-delay="0.9s">
                </div>

            </div>

        </div>
        <div class="swiper-slide bg4">
            <div class="ani">
                <img class="z4_title_img ani" swiper-animate-effect="rotateInDownRight" swiper-animate-duration="0.5s"
                     swiper-animate-delay="0.1s">
                <div class="z4_content">

                    <h3 class="ani" swiper-animate-effect="flip" swiper-animate-duration="0.5s"
                        swiper-animate-delay="0.3s"></h3>
                    <p class="ani" swiper-animate-effect="fadeInLeft" swiper-animate-duration="0.8s"
                       swiper-animate-delay="0.5s" id="p1"></p>
                    <p class="ani" swiper-animate-effect="fadeInDownBig" swiper-animate-duration="1.0s"
                       swiper-animate-delay="0.7s" id="p2"></p>
                    <img class="ani" swiper-animate-effect="lightSpeedIn" swiper-animate-duration="1.3s"
                         swiper-animate-delay="0.9s">
                </div>

                <img class="z4_foot_img ani" swiper-animate-effect="rotateInDownLeft" swiper-animate-duration="0.5s"
                     swiper-animate-delay="0.1s">
            </div>

        </div>
        <!--<div class="swiper-slide">-->
        <!--<iframe style="width: 100%;height: 100%;" src="luck.html"></iframe>-->
        <!--</div>-->
    </div>
    <!-- Add Pagination -->
    <div class="swiper-pagination"></div>
</div>

<!--表单-->
<div class="box" id="form" hidden>

    <div class="box-1 ani" align="center" style="margin: 10%" swiper-animate-effect="lightSpeedIn" swiper-animate-duration="0.5s"
         swiper-animate-delay="0.1s">
        <div style="margin: 0 auto">
            <img style="width: 100%" id="form_title_img">
        </div>
        <form class="layui-form" action="" >

            <div class="item">
                <input type="text" name="name" lay-verify="required" autocomplete="off" placeholder="姓名"
                       class="layui-input">
            </div>
            <div class="item">
                <input type="text" name="mobile" lay-verify="required|phone" autocomplete="off" placeholder="手机号"
                       class="layui-input">
            </div>

            <div class="item verbox">
                <input style="float: left;width: 60%;border: 0" type="text" name="code" lay-verify="vercode"
                       autocomplete="off" placeholder="验证码"
                       class="layui-input">
                <!--<button class="verbtn" style="float: right;width: 40%;height: 100%" >获取验证码</button>-->
                <input id="btnSendCode" type="button" value="发送验证码" onclick="sendMessage()" />
            </div>
            <div class="button">
                {if isset($actid) && isset($cid)}
                <button type="button" style="border: 1px solid red" class="layui-btn sub-btn" lay-submit=""  id="subbtn"
                        onclick="receive('{$actid}','{$userid}','{$cid}');">立即提交</button>
                {else/}

                <button disabled class="layui-btn sub-btn" lay-submit="" lay-filter="sub" id="subbtn">立即提交</button>
                {/if}
            </div>
        </form>
    </div>
</div>
<!--表单-->

<!-- Swiper JS -->
<script src="//captcha.luosimao.com/static/dist/api.js"></script>
<script src="/static/extend_res/swiper/js/swiper-4.3.3.min.js"></script>
<script src="/static/extend_res/swiper/js/swiper.animate1.0.3.min.js"></script>
<script src="/static/extend_res/jquery/jquery-3.3.1.js"></script>
<script src="/static/layui/layui.js"></script>
<script src="/static/temp/tpl002/js/t1.js"></script>

<!-- Initialize Swiper -->
<script>
    $(function () {

        //使用getJSON方法读取json数据,
        //注意：info.json可以是不同类型文件，只要其中的数据为json类型即可
        {if isset($myid)}
        var page = window.parent.getnum();
        $("[aria-label='Go to slide " + page + "']").click();
        var url = "{:url('showtpl/get_json_res')}?myid={$myid}";
        {elseif isset($actid) }
        var url = "{:url('showtpl/get_json_release')}?actid={$actid}";
        {else /}
        var url = "{:url('showtpl/get_json_res_tplmgmt')}?tplid={$tplid}";
        {/if}

        $.getJSON(url, function (data) {
            //给所有页面设置logo
            //  $("[id='logo']").attr('src', data.logo);
            //页面1的内容
            $('title').text(data.public.title.value);
            $('.bg1').css('background-image', "url(" + data.data[0].background.value + ")");
            $('.z1_title').css('background-image', "url(" + data.data[0].title_img.value + ")");
            $('.z1_foot_left').css('background-image', "url(" + data.data[0].foot_left.value + ")");
            $('.z1_foot_right').css('background-image', "url(" + data.data[0].foot_right.value + ")");
            $('.z1_title h1').text(data.data[0].title.value);
            $('.z1_content h3').text(data.data[0].Subtitle.value);
            $('.z1_content p').text(data.data[0].content.value);
            //页面2的内容
            $('.bg2').css('background-image', "url(" + data.data[1].background.value + ")");
            $('.z2_title_img').attr("src", data.data[1].title_img.value);
            $('.z2_content h3').text(data.data[1].title.value);
            $('.z2_content p').text(data.data[1].content.value);
            $('.z2_content img').attr("src", data.data[1].z2_img.value);
            //页面3的内容
            $('.bg3').css('background-image', "url(" + data.data[2].background.value + ")");
            $('.z3_title_img').attr("src", data.data[2].title_img.value);
            $('.z3_content h3').text(data.data[2].title.value);
            $('.z3_content p').text(data.data[2].content.value);
            $('.z3_content img').attr("src", data.data[2].z3_img.value);
            //页面4的内容
            $('.bg4').css('background-image', "url(" + data.data[3].background.value + ")")
            $('.z4_title_img').attr("src", data.data[3].title_img.value);
            $('.z4_content h3').text(data.data[3].title.value);
            $("#p1").text(data.data[3].content1.value);
            $("#p2").text(data.data[3].content2.value);
            $('.z4_content img').attr("src", data.data[3].z4_img.value);
            $('.z4_foot_img').attr("src", data.data[3].foot_img.value);
            if(data.public.isShow.value==1){
                $('#subbtn').text(data.public.subname.value);
                var page=".bg"+ data.public.formpage.value;
                var formhtml=$("#form").html();
                 $(page).html(formhtml);
                $(page).css('background-image', "url(" +  data.public.background.value + ")")
                $("#form_title_img").attr('src',data.public.title_img.value)
            }
        })
    });
    var swiper = new Swiper('.swiper-container', {
        direction: 'vertical',
        effect: 'fade',
        mousewheel: true,
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        on: {
            init: function () {
                swiperAnimateCache(this); //隐藏动画元素
                swiperAnimate(this); //初始化完成开始动画
            },
            slideChangeTransitionEnd: function () {
                swiperAnimate(this); //每个slide切换结束时也运行当前slide动画
            }
        }
    });
    function receive(actid,userid,cid) {
        var mobile = $('[name="mobile"]').val();
        var name = $('[name="name"]').val();
        if (!/^1[34578]\d{9}$/.test(mobile)) {
            layer.alert('请输入正确的手机号');
            return false;
        }
        $.post('/api/v1/Shows/collect', {mobile: mobile, actid: actid,userid:userid,name:name,cid:cid}, function (res) {
            if (res.success) {
                var return_url = '{:url("showtpl/activeBack")}?actid='+actid+'&uid='+res.data.id+'&userid='+res.data.userid;
                layer.msg(res.msg, {icon: 6});

                layer.alert(res.msg, {
                    icon: 6,
                    skin: 'layui-layer-lan' //样式类名
                    , closeBtn: 0
                }, function (index) {
                    layer.close(index);
                    window.location.href = return_url;
                });
            } else {
                layer.msg(res.msg, {icon: 5})
            }
        })
    };
</script>
</body>
</html>
